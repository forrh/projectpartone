<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="main.css" />
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="darkmode.css" />
    <link rel="stylesheet" href="testing.css" />
    <link rel="stylesheet" href="registration.css" />
</head>
<body>

    <div id="registration-tab-header" class="tab-header" style="display: none;">
        <span id="registration-tab" class="tab active-tab">
            <i class="fas fa-clipboard-list" style="color: #007bff;"></i>
            Registration
            <span class="close-tab-btn" onclick="closeRegistrationTab()">&times;</span>
        </span>
    </div>

    <div id="registration-category-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content small-modal">
            <div class="modal-header">
                <h3>Registration: Enter Category</h3>
                <span class="close-btn" onclick="closeModal('registration-category-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="category-select">Category:</label>
                    <select id="category-select" class="form-control" onchange="checkCategorySelection(this.value)">
                        <option value="">Select a category</option>
                        <option value="crushing-testing">crushing testing CT</option>
                        <option value="other">Other Testing OT</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div id="registration-content" class="registration-form-container form-disabled" style="display: none;">
        <div class="sub-tabs">
            <span class="sub-tab active-sub-tab" onclick="showSubTab('compressive-strength')">Comprehensive Strength Test</span>
            <span class="sub-tab" onclick="showSubTab('other-tests')">Other Tests</span>
        </div>
        
        <div id="compressive-strength" class="sub-tab-content active-sub-tab-content">
            <form id="concrete-crushing-form">
                <div class="form-section-title">Order Information</div>
                <div class="form-grid-4-cols">
                    <div class="form-group-with-icons">
                        <label for="order-no">Order No.:</label>
                        <input type="text" id="order-no" class="form-control" placeholder="[EditValue is null]" disabled>
                    </div>
                    <div class="form-group-with-icons">
                        <label for="sample-no">Sample No.:</label>
                        <input type="text" id="sample-no" class="form-control" placeholder="[EditValue is null]" disabled>
                    </div>
                    <div class="form-group-with-icons">
                        <label for="project-code">Project Code</label>
                        <div class="input-with-icon custom-autocomplete-container">
                            <input type="text" id="project-code" class="form-control" placeholder="[EditValue is null]" disabled>
                            <div class="project-code-icons">
                                <i class="fas fa-search icon-btn" data-onclick="openProjectCodeDropdown()" title="Search Project Code"></i>
                                <i class="fas fa-check icon-btn-check" data-onclick="confirmProjectCode()" title="Confirm Project Code"></i>
                                <i class="fas fa-clipboard-check icon-btn-confirmation" data-onclick="openConfirmationSelectionModal()" title="Select from Confirmation"></i>
                            </div>
                            <div class="custom-dropdown-project-code" id="project-code-dropdown" style="display: none;">
                                <div class="dropdown-header">
                                    <div class="header-column" style="width: 25%;">Project Code</div>
                                    <div class="header-column" style="width: 25%;">Project No.</div>
                                    <div class="header-column" style="width: 25%;">Project Name</div>
                                    <div class="header-column" style="width: 25%;">Customer Name</div>
                                </div>
                                <ul class="dropdown-options-list" id="project-code-options">
                                    <li data-onclick="selectProjectCode('AAM-KH-001', 'KH-001', 'مشروع خالد', 'خالد')">
                                        <div class="option-column" style="width: 25%;">AAM-KH-001</div>
                                        <div class="option-column" style="width: 25%;">KH-001</div>
                                        <div class="option-column" style="width: 25%;">مشروع خالد</div>
                                        <div class="option-column" style="width: 25%;">خالد</div>
                                    </li>
                                    <li data-onclick="selectProjectCode('AAM-MH-002', 'MH-002', 'مشروع محمد', 'محمد')">
                                        <div class="option-column" style="width: 25%;">AAM-MH-002</div>
                                        <div class="option-column" style="width: 25%;">MH-002</div>
                                        <div class="option-column" style="width: 25%;">مشروع محمد</div>
                                        <div class="option-column" style="width: 25%;">محمد</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="form-group-with-icons">
                        <label for="lab">Lab:</label>
                        <div class="input-with-icon custom-autocomplete-container">
                            <input type="text" id="lab" class="form-control" placeholder="[EditValue is null]" disabled>
                            <i class="fas fa-caret-down icon-btn" data-onclick="openLabDropdown()"></i>
                            <div class="custom-dropdown-lab" id="lab-dropdown" style="display: none;">
                                <div class="dropdown-header">
                                    <div class="header-column" style="width: 25%;">Location Name</div>
                                    <div class="header-column" style="width: 25%;">Department</div>
                                </div>
                                <ul class="dropdown-options-list" id="lab-options">
                                    <li data-onclick="selectLab('Default Location', 'Materials Testing')">
                                        <div class="option-column" style="width: 25%;">Default Location</div>
                                        <div class="option-column" style="width: 25%;">Materials Testing</div>
                                    </li>
                                    <li data-onclick="selectLab('Concrete Section', 'Materials Testing')">
                                        <div class="option-column" style="width: 25%;">Concrete Section</div>
                                        <div class="option-column" style="width: 25%;">Materials Testing</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

              <div class="form-grid-4-cols">
    <div class="form-group-with-icons">
        <label for="order-date">Order Date.:</label>
        <div class="input-with-icon">
            <input type="text" id="order-date" class="form-control" disabled>
        </div>
    </div>

                    <div class="form-group-with-icons span-2-cols">
                        <label for="project">Project:</label>
                        <input type="text" id="project" class="form-control" disabled>
                    </div>
                    <div class="form-group-with-icons">
                        <label for="s-contractor">S. Contractor:</label>
                        <input type="text" id="s-contractor" class="form-control" placeholder="[EditValue is null]" disabled>
                    </div>
                </div>

                <div class="form-grid-4-cols">
                    <div class="form-group-with-icons">
                        <label for="project-no">Project No.:</label>
                        <input type="text" id="project-no" class="form-control" disabled>
                    </div>
                    <div class="form-group-with-icons span-2-cols">
                        <label for="customer">Customer:</label>
                        <input type="text" id="customer" class="form-control" disabled>
                    </div>
                    <div class="form-group-with-icons">
                        <label for="payment-terms">Payment Terms:</label>
                        <input type="text" id="payment-terms" class="form-control" placeholder="[EditValue is null]" disabled>
                    </div>
                </div>

                <div class="form-grid-4-cols">
                    <div class="form-group-with-icons">
                        <label for="pouring-ticket">Pouring Ticket:</label>
                        <div class="input-with-icon pouring-ticket-icons">
                            <input type="text" id="pouring-ticket" class="form-control" disabled>
                            <i class="fas fa-check icon-btn-check" data-onclick="validatePouringTicket()"></i>
                            <i class="fas fa-arrow-right icon-btn-arrow" data-onclick="fetchPouringTicketDetails()"></i>
                        </div>
                    </div>
                    
                    <div class="form-group-with-icons">
                        <label for="confirmation">Confirmation:</label>
                        <div class="input-with-icon custom-autocomplete-container">
                            <input type="text" id="confirmation" class="form-control" placeholder="[EditValue is null]" disabled>
                            
                        </div>
                    </div>
                </div>

                <div class="form-section-title">Sample Information</div>
                <div class="form-grid-3-cols">

                    <div class="form-group">
                        <label for="sample-source">Sample Source:</label>
                        <div class="input-with-icon">
                            <input type="text" id="sample-source" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSampleSourceDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sample-description">Sample Description:</label>
                        <div class="input-with-icon">
                            <input type="text" id="sample-description" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSampleDescriptionDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="rfi-wir">RFI/WIR:</label>
                        <input type="text" id="rfi-wir" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="structure-ref">Structure Ref.:</label>
                        <input type="text" id="structure-ref" class="form-control" disabled>
                    </div>
                    <div class="form-group">
                        <label for="sampling-method">Sampling Method:</label>
                        <div class="input-with-icon">
                            <input type="text" id="sampling-method" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSamplingMethodDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="received-at">Received :</label>
                        <input type="datetime-local" id="received-at" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="total-received">Total Received:</label>
                        <input type="number" id="total-received" class="form-control" value="0" disabled>
                    </div>
                    <div class="form-group">
                        <label for="spec-prop-by">Spec. Prop. By:</label>
                        <div class="input-with-icon">
                            <input type="text" id="spec-prop-by" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSpecPropByDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sampled-at">Sampled :</label>
                        <input type="datetime-local" id="sampled-at" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="received-by">Received By:</label>
                        <div class="input-with-icon">
                            <input type="text" id="received-by" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openReceivedByDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sampled-by">Sampled By:</label>
                        <div class="input-with-icon">
                            <input type="text" id="sampled-by" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSampledByDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="casted-at">Casted :</label>
                        <input type="datetime-local" id="casted-at" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="samp-brought-by">Samp. Brght. By:</label>
                        <div class="input-with-icon">
                            <input type="text" id="samp-brought-by" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openSampBroughtByDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="comp-equipment">Comp. Equipment:</label>
                        <div class="input-with-icon">
                            <input type="text" id="comp-equipment" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openCompEquipmentDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="witness">Witness:</label>
                        <input type="text" id="witness" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="mtd-of-comp">Mthd of Comp.:</label>
                        <div class="input-with-icon">
                            <input type="text" id="mtd-of-comp" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openMthdOfCompDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cement-content">Cement Content:</label>
                        <input type="text" id="cement-content" class="form-control" disabled>
                    </div>
                    <div class="form-group">
                        <label for="notes">Notes:</label>
                        <input type="text" id="notes" class="form-control" disabled>
                    </div>

                    <div class="form-group">
                        <label for="cement-type">Cement Type:</label>
                        <div class="input-with-icon">
                            <input type="text" id="cement-type" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openCementTypeDropdown()"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="nominal-size">Nominal Size:</label>
                        <input type="text" id="nominal-size" class="form-control" disabled>
                    </div>
                    <div class="form-group">
                        <label for="class">Class:</label>
                        <div class="input-with-icon">
                            <input type="text" id="class" class="form-control" disabled>
                            <i class="fas fa-caret-down icon-btn" onclick="openClassDropdown()"></i>
                        </div>
                    </div>
                </div>
                <div class="form-section-title">Test Information</div>
                <div class="test-table-container">
                    <table class="test-data-table">
                        <thead>
                            <tr>
                                <th>Test Method</th>
                                <th>R. Age</th>
                                <th>A. Age</th>
                                <th>Price</th>
                                <th>QTY</th>
                                <th>Scheduled @</th>
                                <th>Rem.</th>
                                <th>Test Location</th>
                                <th>Report No.</th>
                                <th>Rev.</th>
                                <th>Items</th>
                                <th><i class="fas fa-plus" onclick="addNewTestRow()"></i></th>
                            </tr>
                        </thead>
                        <tbody id="test-table-body">
                            <tr>
                                <td>
                                    <div class="input-with-icon">
                                        <input type="text" class="form-control" disabled data-dropdown="test-method-dropdown">
                                        <i class="fas fa-caret-down icon-btn" onclick="openDropdown(this, 'test-method-dropdown')"></i>
                                    </div>
                                </td>
                                <td><input type="number" class="form-control" value="0" disabled/></td>
                                <td><input type="number" class="form-control" value="0" disabled/></td>
                                <td><input type="number" class="form-control" value="0" disabled/></td>
                                <td><input type="number" class="form-control" value="0" disabled/></td>
                                <td>
                                    <div class="input-with-icon">
                                        <input type="datetime-local" class="form-control" disabled/>
                                        <i class="fas fa-calendar-alt icon-btn" onclick="openCalendar(this)"></i>
                                    </div>
                                </td>
                                <td><input type="text" class="form-control" disabled/></td>
                                <td>
                                    <div class="input-with-icon">
                                        <input type="text" class="form-control" disabled data-dropdown="test-location-dropdown">
                                        <i class="fas fa-caret-down icon-btn" onclick="openDropdown(this, 'test-location-dropdown')"></i>
                                    </div>
                                </td>
                                <td><input type="text" class="form-control" value="[Auto]" readonly disabled/></td>
                                <td><input type="text" class="form-control" value="0" readonly disabled/></td>
                                <td>
                                    <i class="fas fa-box items-icon" onclick="openItemsModal(this)"></i>
                                </td>
                                <td>
                                    <i class="fas fa-trash-alt delete-row" onclick="deleteTestRow(this)"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </form>
        </div>

        <div id="other-tests" class="sub-tab-content">
            <p>Content for Other Tests...</p>
        </div>
    </div>

    <div class="form-footer-buttons" id="form-footer-buttons" style="display: none;">
    <div class="order-no-footer">
        <label for="order-number-footer">Order No.:</label>
        <div class="input-with-icon custom-autocomplete-container">
            <input type="text" id="order-number-footer" class="form-control footer-order-no-input" placeholder="[EditValue is null]">
            <i class="fas fa-caret-down icon-btn" onclick="toggleOrderNoDropdown()"></i>
            <div class="custom-dropdown-order-no" id="order-no-dropdown" style="display: none;">
                <ul class="dropdown-options-list">
                    <li onclick="selectOrderNo('ORDER-001')">ORDER-001</li>
                    <li onclick="selectOrderNo('ORDER-002')">ORDER-002</li>
                    <li onclick="selectOrderNo('ORDER-003')">ORDER-003</li>
                </ul>
            </div>
        </div>
    </div>
    <button class="btn btn-secondary" id="actions-btn" disabled>
        <i class="fas fa-user-friends"></i> Actions
    </button>
    <button class="btn btn-secondary" id="close-btn" onclick="closeRegistrationTab()">
        <i class="fas fa-times"></i> Close
    </button>
    <button class="btn btn-primary" id="new-btn" onclick="enableForm()">
        <i class="fas fa-plus"></i> New
    </button>
    <button class="btn btn-success" id="save-close-btn" disabled>
        <i class="fas fa-save"></i> Save & Close
    </button>
    <button class="btn btn-success" id="save-btn" disabled>
        <i class="fas fa-save"></i> Save
    </button>
</div>
    
    <div id="confirmation-selection-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>Select from Confirmation</h3>
                <span class="close-btn" onclick="closeModal('confirmation-selection-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-controls">
                    <input type="text" id="confirmation-search-input" class="form-control" placeholder="Search by C. Description or C. S/T ID...">
                    <button class="btn btn-primary" onclick="applySelectedConfirmation()">Select</button>
                    <button class="btn btn-secondary" onclick="closeModal('confirmation-selection-modal')">Cancel</button>
                </div>
                <div class="table-container">
                    <table class="confirmation-table">
                        <thead>
                            <tr>
                                <th style="width: 5%;"></th> <th style="width: 15%;">C. Description</th>
                                <th style="width: 5%;">Accounted</th>
                                <th style="width: 10%;">Conf. Date</th>
                                <th style="width: 10%;">C. S/T ID</th>
                                <th style="width: 10%;">Alt. Test ID</th>
                                <th style="width: 15%;">Service/Field Description</th>
                                <th style="width: 5%;">Passed QTY</th>
                                <th style="width: 5%;">Rem. QTY</th>
                                <th style="width: 10%;">C. Price</th>
                                <th style="width: 5%;">Schedule #</th>
                                <th style="width: 5%;">Expected</th>
                            </tr>
                        </thead>
                        <tbody id="confirmation-table-body">
                            <tr data-onclick="selectRow(this)">
                                <td><input type="checkbox" class="confirmation-checkbox"></td>
                                <td>Item 1 from Quote</td>
                                <td>Yes</td>
                                <td>2025-08-11</td>
                                <td>CS-001</td>
                                <td>ALT-001</td>
                                <td>Field Test 1</td>
                                <td>10</td>
                                <td>5</td>
                                <td>150.00</td>
                                <td>SCH-01</td>
                                <td>15</td>
                            </tr>
                            <tr data-onclick="selectRow(this)">
                                <td><input type="checkbox" class="confirmation-checkbox"></td>
                                <td>Item 2 from Quote</td>
                                <td>No</td>
                                <td>2025-08-12</td>
                                <td>CS-002</td>
                                <td>ALT-002</td>
                                <td>Field Test 2</td>
                                <td>8</td>
                                <td>2</td>
                                <td>200.50</td>
                                <td>SCH-02</td>
                                <td>10</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="registration.js"></script>
    <script src="main.js"></script>
</body>
</html>
